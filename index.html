<!-- index.html -->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Vdocipher Video</title>
</head>
<body>
    <header>
        <h1>Welcome to My Basic Website</h1>
    </header>

    <section>
        <h2>About Us</h2>
        <p>This is a simple website created for demonstration purposes.</p>
    </section>

    <section>
        <h2>Iframet</h2>
        <p>iframe embedded video</p>
        <div style="padding-top:56%;position:relative;">
<iframe src="https://player.vdocipher.com/v2/?otp=20160313versUSE323wxHRPl9pI7nFncl8AkMbL1kA0a5586VsgmDe1Ecnn0TSQo&playbackInfo=eyJ2aWRlb0lkIjoiMWVjZWE3M2JmMTA0NGFiYjkwZDRmZWMxYjliMzk4NzIifQ==" style="border:0;max-width:100%;position:absolute;top:0;left:0;height:100%;width:100%;" allowFullScreen="true" allow="encrypted-media"></iframe>
</div>
    </section>



    <section>
        <h2>API embedded video</h2>
        <div id="vdocipherVideo"></div>
    </section>

    <!-- Vdocipher Video Embedding Script -->
    <script>
        const vdocipherApiKey = 'rAJ0b4D8snjx8zSLc6MArhRpRnkhCXyJzWQUEf689ppBbxSLMCpsIZyDclNqkftu';

        // Step 1: Make API request to obtain OTP
        fetch(`/api/getVdocipherOTP`, {  // Use the relative path to your serverless function
            method: 'POST',
            headers: {
                'Accept': 'application/json',
                'Authorization': `Apisecret ${vdocipherApiKey}`,
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({
                ttl: 300
            })
        })
        .then(response => response.json())
        .then(data => {
            // Step 2: Use the OTP and playbackInfo in embed code
            const otp = data.otp;
            const playbackInfo = data.playbackInfo;

            // Embed the video player
            const vdocipherPlayer = document.getElementById('vdocipherVideo');
            vdocipherPlayer.innerHTML = `
                <iframe
                    src="https://player.vdocipher.com/v2/?otp=${otp}&playbackInfo=${playbackInfo}"
                    style="border:0;width:100%;height:400px;"
                    allow="encrypted-media"
                    allowfullscreen
                ></iframe>
            `;
        })
        .catch(error => {
            console.error('Error:', error);
            // Handle error as needed
        });
    </script>
</body>
</html>
